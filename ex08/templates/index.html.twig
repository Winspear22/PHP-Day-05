{% extends 'base.html.twig' %}

{% block title %}Ex08 — Structure & Relations SQL{% endblock %}

{% block body %}
<h1>Ex08 — Structure des tables et relations</h1>

{# Messages flash #}
{% for msg in app.flashes('notice') %}
    <div class="alert">{{ msg }}</div>
{% endfor %}

<div style="max-width: 600px; margin: 2.5em auto;">
    <table>
        <tr>
            <th>Table</th>
            <th>État</th>
        </tr>
        <tr>
            <td>persons</td>
            <td>
                {% if tablesStatus.persons == 0 %}
                    <span style="color:#27ae60; font-weight:bold;">✅ Existant</span>
                {% else %}
                    <span style="color:#e67e22; font-weight:bold;">❌ Absent</span>
                {% endif %}
            </td>
        </tr>
        <tr>
            <td>addresses</td>
            <td>
                {% if tablesStatus.addresses == 0 %}
                    <span style="color:#27ae60; font-weight:bold;">✅ Existant</span>
                {% else %}
                    <span style="color:#e67e22; font-weight:bold;">❌ Absent</span>
                {% endif %}
            </td>
        </tr>
        <tr>
            <td>bank_accounts</td>
            <td>
                {% if tablesStatus.bank_accounts == 0 %}
                    <span style="color:#27ae60; font-weight:bold;">✅ Existant</span>
                {% else %}
                    <span style="color:#e67e22; font-weight:bold;">❌ Absent</span>
                {% endif %}
            </td>
        </tr>
    </table>
</div>

<div style="max-width: 600px; margin: 2.5em auto;">
    <table>
        <tr>
            <th>Colonne ou Relation</th>
            <th>État</th>
        </tr>
        <tr>
            <td>persons.marital_status</td>
            <td>
                {% if maritalStatus == 0 %}
                    <span style="color:#27ae60; font-weight:bold;">✅ Ajoutée</span>
                {% else %}
                    <span style="color:#e67e22; font-weight:bold;">❌ Absente</span>
                {% endif %}
            </td>
        </tr>
        <tr>
            <td>addresses.person_id (one-to-many)</td>
            <td>
                {% if relationAddresses == 0 %}
                    <span style="color:#27ae60; font-weight:bold;">✅ Présente</span>
                {% else %}
                    <span style="color:#e67e22; font-weight:bold;">❌ Absente</span>
                {% endif %}
            </td>
        </tr>
        <tr>
            <td>bank_accounts.person_id (one-to-one)</td>
            <td>
                {% if relationBankAccount == 0 %}
                    <span style="color:#27ae60; font-weight:bold;">✅ Présente</span>
                {% else %}
                    <span style="color:#e67e22; font-weight:bold;">❌ Absente</span>
                {% endif %}
            </td>
        </tr>
    </table>
</div>

<div class="form-wrapper" style="max-width: 600px; margin: 2em auto;">
    <form method="post" action="{{ path('ex08_create_persons') }}">
        <button type="submit">Créer la table persons</button>
    </form>
    <form method="post" action="{{ path('ex08_create_address_tables') }}">
        <button type="submit">Créer la table addresses</button>
    </form>
    <form method="post" action="{{ path('ex08_create_BankAccount_tables') }}">
        <button type="submit">Créer la table bank_accounts</button>
    </form>
    <form method="post" action="{{ path('ex08_add_marital_status') }}">
        <button type="submit">Ajouter marital_status</button>
    </form>
    <form method="post" action="{{ path('ex08_add_relation_addresses') }}">
        <button type="submit">Ajouter relation persons → addresses (one-to-many)</button>
    </form>
    <form method="post" action="{{ path('ex08_add_relation_bank_account') }}">
        <button type="submit">Ajouter relation persons → bank_accounts (one-to-one)</button>
    </form>
    <form method="post" action="{{ path('ex08_drop_tables') }}">
        <button type="submit" style="background:#e84c3d; margin-top:1.5em;">❌ Supprimer toutes les tables</button>
    </form>
</div>
{% endblock %}
